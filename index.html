<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, maximum-scale=5.0">
    <title>Farm Record Management System</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <!-- Improved Mobile Navigation -->
        <nav class="navbar">
            <div class="nav-content">
                <div class="nav-brand">
                    <h2>üå± Farm Records</h2>
                </div>
                <button class="nav-toggle" id="navToggle" aria-label="Toggle navigation">
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                </button>
            </div>
            <!-- Mobile Overlay Menu -->
            <div class="nav-overlay" id="navOverlay"></div>
            <div class="nav-menu" id="navMenu">
                <div class="nav-header">
                    <h3>Navigation</h3>
                    <button class="nav-close" id="navClose">‚úï</button>
                </div>
                <div class="nav-items">
                    <button class="nav-item active" data-section="dashboard">
                        <span class="nav-icon">üìä</span>
                        <span class="nav-text">Dashboard</span>
                    </button>
                    <button class="nav-item" data-section="farms">
                        <span class="nav-icon">üè°</span>
                        <span class="nav-text">Farms</span>
                    </button>
                    <button class="nav-item" data-section="applications">
                        <span class="nav-icon">üå±</span>
                        <span class="nav-text">Applications</span>
                    </button>
                    <button class="nav-item" data-section="crops">
                        <span class="nav-icon">üåæ</span>
                        <span class="nav-text">Crops</span>
                    </button>
                    <button class="nav-item" data-section="records">
                        <span class="nav-icon">üìã</span>
                        <span class="nav-text">Records</span>
                    </button>
                    <button class="nav-item" data-section="timeline">
                        <span class="nav-icon">üìÖ</span>
                        <span class="nav-text">Timeline</span>
                    </button>
                    <button class="nav-item" data-section="historical">
                        <span class="nav-icon">üìà</span>
                        <span class="nav-text">Historical</span>
                    </button>
                </div>
            </div>
        </nav>

        <!-- Main Content with improved spacing -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="section active">
                <div class="section-header">
                    <div class="header-content">
                        <h1>Farm Dashboard</h1>
                        <p class="current-date" id="currentDate"></p>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üè°</div>
                        <div class="stat-info">
                            <h3 id="totalFarms">0</h3>
                            <p>Total Farms</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üå±</div>
                        <div class="stat-info">
                            <h3 id="recentApplications">0</h3>
                            <p>Recent Applications</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üåæ</div>
                        <div class="stat-info">
                            <h3 id="recentCrops">0</h3>
                            <p>Active Crops</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìä</div>
                        <div class="stat-info">
                            <h3 id="totalRecords">0</h3>
                            <p>Total Records</p>
                        </div>
                    </div>
                </div>

                <div class="dashboard-content">
                    <div class="recent-activities">
                        <h3>üìù Recent Activities</h3>
                        <div id="activityList" class="activity-list"></div>
                    </div>
                    <div class="quick-actions">
                        <h3>‚ö° Quick Actions</h3>
                        <div class="action-buttons">
                            <button class="btn btn--primary btn--mobile" onclick="switchSection('farms')">
                                üè° Add Farm
                            </button>
                            <button class="btn btn--primary btn--mobile" onclick="switchSection('applications')">
                                üå± Record Application
                            </button>
                            <button class="btn btn--primary btn--mobile" onclick="switchSection('crops')">
                                üåæ Add Crop
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Farms Section -->
            <section id="farms" class="section">
                <div class="section-header">
                    <div class="header-content">
                        <h1>üè° Farm Management</h1>
                    </div>
                    <button class="btn btn--primary btn--mobile" onclick="showAddFarmForm()">
                        ‚ûï Add New Farm
                    </button>
                </div>

                <div class="farm-form card mobile-card" id="farmForm" style="display: none;">
                    <div class="card__body">
                        <h3>‚ûï Add New Farm</h3>
                        <form id="addFarmForm">
                            <div class="form-group">
                                <label class="form-label">Farm Name *</label>
                                <input type="text" class="form-control" id="farmName" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Farm ID *</label>
                                <input type="text" class="form-control" id="farmId" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Location</label>
                                <input type="text" class="form-control" id="farmLocation">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Size (acres)</label>
                                <input type="number" class="form-control" id="farmSize" min="0" step="0.1">
                            </div>
                            <div class="form-actions mobile-actions">
                                <button type="submit" class="btn btn--primary btn--mobile">‚ûï Add Farm</button>
                                <button type="button" class="btn btn--outline btn--mobile" onclick="hideFarmForm()">‚ùå Cancel</button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="farms-list">
                    <div class="mobile-table-container">
                        <table class="data-table mobile-table" id="farmsTable">
                            <thead>
                                <tr>
                                    <th>Farm</th>
                                    <th>Location</th>
                                    <th>Size</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="farmsTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Applications Section -->
            <section id="applications" class="section">
                <div class="section-header">
                    <div class="header-content">
                        <h1>üå± Application Records</h1>
                    </div>
                </div>

                <div class="application-form card mobile-card">
                    <div class="card__body">
                        <h3>üìù Record New Application</h3>
                        <form id="addApplicationForm">
                            <div class="form-group">
                                <label class="form-label">Product Type *</label>
                                <select class="form-control" id="productType" required>
                                    <option value="">Select Type</option>
                                    <option value="Fertilizer">üå± Fertilizer</option>
                                    <option value="Pesticide">üêõ Pesticide</option>
                                    <option value="Herbicide">üåø Herbicide</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Product Name *</label>
                                <input type="text" class="form-control" id="productName" required placeholder="e.g. NPK 10-10-10">
                            </div>
                            <div class="form-row mobile-form-row">
                                <div class="form-group">
                                    <label class="form-label">Quantity *</label>
                                    <input type="number" class="form-control" id="quantity" min="0" step="0.1" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Unit</label>
                                    <select class="form-control" id="unit">
                                        <option value="kg">kg</option>
                                        <option value="liters">liters</option>
                                        <option value="bags">bags</option>
                                        <option value="pounds">pounds</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Application Date *</label>
                                <input type="date" class="form-control" id="applicationDate" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Farm *</label>
                                <select class="form-control" id="applicationFarm" required>
                                    <option value="">Select Farm</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Crop Applied To *</label>
                                <select class="form-control" id="applicationCrop" required>
                                    <option value="">Select Crop</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Application Method</label>
                                <select class="form-control" id="applicationMethod">
                                    <option value="Spray">üöø Spray</option>
                                    <option value="Granular">‚ö™ Granular</option>
                                    <option value="Liquid">üíß Liquid</option>
                                    <option value="Injection">üíâ Injection</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Notes</label>
                                <textarea class="form-control" id="applicationNotes" rows="3" placeholder="Additional notes..."></textarea>
                            </div>
                            <div class="form-actions mobile-actions">
                                <button type="submit" class="btn btn--primary btn--mobile">üìù Record Application</button>
                                <button type="reset" class="btn btn--outline btn--mobile">üîÑ Reset Form</button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="applications-list">
                    <h3>üìã Recent Applications</h3>
                    <div class="mobile-table-container">
                        <div class="table-scroll">
                            <table class="data-table mobile-table" id="applicationsTable">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Product</th>
                                        <th>Crop</th>
                                        <th>Qty</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="applicationsTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Crops Section -->
            <section id="crops" class="section">
                <div class="section-header">
                    <div class="header-content">
                        <h1>üåæ Crop Management</h1>
                    </div>
                </div>

                <div class="crop-form card mobile-card">
                    <div class="card__body">
                        <h3>üå± Add New Crop</h3>
                        <form id="addCropForm">
                            <div class="form-group">
                                <label class="form-label">Crop Name *</label>
                                <input type="text" class="form-control" id="cropName" required placeholder="e.g. Corn, Wheat, Soybeans">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Variety</label>
                                <input type="text" class="form-control" id="cropVariety" placeholder="e.g. Sweet Corn, Winter Wheat">
                            </div>
                            <div class="form-row mobile-form-row">
                                <div class="form-group">
                                    <label class="form-label">Plantation Date *</label>
                                    <input type="date" class="form-control" id="plantationDate" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Expected Harvest</label>
                                    <input type="date" class="form-control" id="harvestDate">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Farm *</label>
                                <select class="form-control" id="cropFarm" required>
                                    <option value="">Select Farm</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Area (acres)</label>
                                <input type="number" class="form-control" id="cropArea" min="0" step="0.1" placeholder="0.0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Notes</label>
                                <textarea class="form-control" id="cropNotes" rows="3" placeholder="Crop notes..."></textarea>
                            </div>
                            <div class="form-actions mobile-actions">
                                <button type="submit" class="btn btn--primary btn--mobile">üå± Add Crop</button>
                                <button type="reset" class="btn btn--outline btn--mobile">üîÑ Reset Form</button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="crops-list">
                    <h3>üåæ Current Crops</h3>
                    <div class="mobile-table-container">
                        <div class="table-scroll">
                            <table class="data-table mobile-table" id="cropsTable">
                                <thead>
                                    <tr>
                                        <th>Crop</th>
                                        <th>Farm</th>
                                        <th>Planted</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="cropsTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Records Section -->
            <section id="records" class="section">
                <div class="section-header">
                    <div class="header-content">
                        <h1>üìã All Records</h1>
                    </div>
                    <div class="export-buttons mobile-export">
                        <button class="btn btn--outline btn--mobile" onclick="exportRecords('pdf')">üìÑ Export PDF</button>
                        <button class="btn btn--outline btn--mobile" onclick="exportRecords('excel')">üìä Export Excel</button>
                    </div>
                </div>

                <!-- Enhanced Charts Section -->
                <div class="charts-section">
                    <div class="chart-card mobile-card">
                        <h3>üìä Application Overview</h3>
                        <div class="chart-container">
                            <canvas id="applicationsChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-card mobile-card">
                        <h3>üåæ Crops by Farm</h3>
                        <div class="chart-container">
                            <canvas id="cropsChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="filters-section card mobile-card">
                    <div class="card__body">
                        <h4>üîç Filter Records</h4>
                        <div class="filters-grid mobile-filters">
                            <div class="form-group">
                                <label class="form-label">Farm</label>
                                <select class="form-control" id="filterFarm">
                                    <option value="">All Farms</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Record Type</label>
                                <select class="form-control" id="filterType">
                                    <option value="">All Types</option>
                                    <option value="fertilizer">Fertilizers</option>
                                    <option value="pesticide">Pesticides</option>
                                    <option value="herbicide">Herbicides</option>
                                    <option value="crop">Crops</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">From Date</label>
                                <input type="date" class="form-control" id="filterFromDate">
                            </div>
                            <div class="form-group">
                                <label class="form-label">To Date</label>
                                <input type="date" class="form-control" id="filterToDate">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Search</label>
                            <input type="text" class="form-control" id="searchRecords" placeholder="Search records...">
                        </div>
                        <div class="filter-actions mobile-actions">
                            <button class="btn btn--primary btn--mobile" onclick="applyFilters()">üîç Apply Filters</button>
                            <button class="btn btn--outline btn--mobile" onclick="clearFilters()">üßπ Clear</button>
                        </div>
                    </div>
                </div>

                <div class="records-list">
                    <div class="mobile-table-container">
                        <div class="table-scroll">
                            <table class="data-table mobile-table" id="recordsTable">
                                <thead>
                                    <tr>
                                        <th onclick="sortRecords('date')">Date ‚Üï</th>
                                        <th onclick="sortRecords('type')">Type ‚Üï</th>
                                        <th onclick="sortRecords('name')">Item ‚Üï</th>
                                        <th>Farm</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="recordsTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Timeline Section -->
            <section id="timeline" class="section">
                <div class="section-header">
                    <div class="header-content">
                        <h1>üìÖ Application Timeline</h1>
                        <p>Fertilizer timeline based on crop plantation dates</p>
                    </div>
                </div>

                <div class="timeline-controls card mobile-card">
                    <div class="card__body">
                        <h4>üéõÔ∏è Timeline Controls</h4>
                        <div class="form-row mobile-form-row">
                            <div class="form-group">
                                <label class="form-label">Select Farm</label>
                                <select class="form-control" id="timelineFarm">
                                    <option value="">All Farms</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Select Year</label>
                                <select class="form-control" id="timelineYear">
                                    <option value="2025">2025</option>
                                    <option value="2024">2024</option>
                                    <option value="2023">2023</option>
                                </select>
                            </div>
                        </div>
                        <button class="btn btn--primary btn--mobile" onclick="loadTimeline()">üìÖ Load Timeline</button>
                    </div>
                </div>

                <div class="timeline-chart card mobile-card">
                    <div class="card__body">
                        <h3>üìà Fertilizer Application Timeline</h3>
                        <div class="chart-container">
                            <canvas id="timelineChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="timeline-comparison card mobile-card">
                    <div class="card__body">
                        <h3>üìä Year-over-Year Comparison</h3>
                        <div class="comparison-stats mobile-stats">
                            <div class="comparison-item">
                                <span class="comparison-label">This Year Applications:</span>
                                <span class="comparison-value" id="timelineThisYear">0</span>
                            </div>
                            <div class="comparison-item">
                                <span class="comparison-label">Last Year Applications:</span>
                                <span class="comparison-value" id="timelineLastYear">0</span>
                            </div>
                            <div class="comparison-item">
                                <span class="comparison-label">Growth Rate:</span>
                                <span class="comparison-value growth" id="timelineGrowth">0%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Historical Section -->
            <section id="historical" class="section">
                <div class="section-header">
                    <div class="header-content">
                        <h1>üìà Historical Data</h1>
                        <p>Comprehensive farm analytics</p>
                    </div>
                </div>

                <div class="historical-stats mobile-stats-grid">
                    <div class="stat-card mobile-stat-card">
                        <h4>üìÖ This Year Applications</h4>
                        <div class="year-comparison mobile-comparison">
                            <span class="current-year" id="thisYearApps">0</span>
                            <span class="comparison-text">vs</span>
                            <span class="last-year" id="lastYearApps">0</span>
                            <span class="comparison-text">last year</span>
                        </div>
                    </div>
                    <div class="stat-card mobile-stat-card">
                        <h4>üå± Fertilizer Usage</h4>
                        <div class="year-comparison mobile-comparison">
                            <span class="current-year" id="thisYearFert">0</span>
                            <span class="comparison-text">vs</span>
                            <span class="last-year" id="lastYearFert">0</span>
                            <span class="comparison-text">applications</span>
                        </div>
                    </div>
                    <div class="stat-card mobile-stat-card">
                        <h4>üêõ Pest Control</h4>
                        <div class="year-comparison mobile-comparison">
                            <span class="current-year" id="thisYearPest">0</span>
                            <span class="comparison-text">vs</span>
                            <span class="last-year" id="lastYearPest">0</span>
                            <span class="comparison-text">applications</span>
                        </div>
                    </div>
                </div>

                <div class="historical-chart card mobile-card">
                    <h3>üìä Monthly Application Trends</h3>
                    <div class="chart-container">
                        <canvas id="historicalChart"></canvas>
                    </div>
                </div>
            </section>
        </main>

        <!-- Improved Mobile Modal -->
        <div class="modal hidden" id="editModal">
            <div class="modal-content mobile-modal">
                <div class="modal-header">
                    <h3 id="modalTitle">‚úèÔ∏è Edit Record</h3>
                    <button class="modal-close" onclick="closeEditModal()" aria-label="Close modal">‚úñÔ∏è</button>
                </div>
                <div class="modal-body" id="modalBody">
                    <!-- Dynamic content will be inserted here -->
                </div>
            </div>
        </div>

        <!-- Enhanced Toast notifications -->
        <div id="toast" class="toast mobile-toast hidden"></div>
    </div>

    <!-- Enhanced Script Loading -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="app.js"></script>
</body>
</html>